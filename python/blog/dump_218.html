
<center>								
<table border="0">
<tbody><tr>
<td width="336" height="280" align="center">

<script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- itguru Top -->
<ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-6608926154840997" data-ad-slot="9540252860" data-adsbygoogle-status="done"><ins id="aswift_1_expand" style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent;"><ins id="aswift_1_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent;"><iframe width="336" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;width:336px;height:280px;"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
	
</td><td width="336" height="280" align="center">

<script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- itguru Top -->
<ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-6608926154840997" data-ad-slot="9540252860" data-adsbygoogle-status="done"><ins id="aswift_2_expand" style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent;"><ins id="aswift_2_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent;"><iframe width="336" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;width:336px;height:280px;"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

</td>
</tr>
</tbody></table>
</center>
<br><br>
<div class="tt_article_useless_p_margin"><p style="line-height: 1.5;">이번 강좌에서는</p><ul style="list-style-type: square;"><li style="line-height: 1.5;">Excel 만들기 프로젝트 완성.</li><li style="line-height: 1.5;">중위 표기법(Infix notation), 후위 표기법(postfix notation) 간의 변환</li></ul><div style="line-height: 1.5;"><hr style="display:block; border: black 0 none; border-top: black 1px solid; height: 1px"></div><p style="text-align: center; clear: none; float: none; line-height: 1.5;"><span class="imageblock" style="display:inline-block;width:730px;;height:auto;max-width:100%"><span data-url="https://t1.daumcdn.net/cfile/tistory/2404D335578FA9AA0F?original" data-lightbox="lightbox"><img srcset="//img1.daumcdn.net/thumb/R1920x0/?fname=http%3A%2F%2Fcfile10.uf.tistory.com%2Fimage%2F2404D335578FA9AA0F1250 1920w, //img1.daumcdn.net/thumb/R960x0/?fname=http%3A%2F%2Fcfile10.uf.tistory.com%2Fimage%2F2404D335578FA9AA0F1250 960w, //img1.daumcdn.net/thumb/R720x0/?fname=http%3A%2F%2Fcfile10.uf.tistory.com%2Fimage%2F2404D335578FA9AA0F1250 720w, //img1.daumcdn.net/thumb/R640x0.q70/?fname=http%3A%2F%2Fcfile10.uf.tistory.com%2Fimage%2F2404D335578FA9AA0F1250 640w, //img1.daumcdn.net/thumb/R480x0.q70/?fname=http%3A%2F%2Fcfile10.uf.tistory.com%2Fimage%2F2404D335578FA9AA0F1250 480w" src="https://t1.daumcdn.net/cfile/tistory/2404D335578FA9AA0F" style="cursor: pointer;max-width:100%;height:auto" width="730" height="158" filename="__CODE____C___by_webblaster48.jpg" filemime="image/jpeg"></span></span></p><p style="line-height: 1.5;"><span style="font-size: 12pt;"><br></span></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">안녕하세요 여러분. 지난 강좌에 이어서 Excel 만들기 프로젝트를 계속&nbsp;진행해 보도록 하겠습니다. 지난 강좌에서는 셀에 문자열 데이터만 넣을 수 있지만, 테이블을 여러가지 형태 (텍스트, HTML, CSV)로 출력할 수 있는 엑셀을 제작하였습니다.</span></p><p style="line-height: 1.5;"><span style="font-size: 12pt;"><br></span></p><p style="text-align: center; clear: none; float: none; line-height: 1.5;"><span class="imageblock" style="display:inline-block;width:640px;;height:auto;max-width:100%"><img srcset="//img1.daumcdn.net/thumb/R1920x0/?fname=http%3A%2F%2Fcfile26.uf.tistory.com%2Fimage%2F2327BB39578FA96F053529 1920w, //img1.daumcdn.net/thumb/R960x0/?fname=http%3A%2F%2Fcfile26.uf.tistory.com%2Fimage%2F2327BB39578FA96F053529 960w, //img1.daumcdn.net/thumb/R720x0/?fname=http%3A%2F%2Fcfile26.uf.tistory.com%2Fimage%2F2327BB39578FA96F053529 720w, //img1.daumcdn.net/thumb/R640x0.q70/?fname=http%3A%2F%2Fcfile26.uf.tistory.com%2Fimage%2F2327BB39578FA96F053529 640w, //img1.daumcdn.net/thumb/R480x0.q70/?fname=http%3A%2F%2Fcfile26.uf.tistory.com%2Fimage%2F2327BB39578FA96F053529 480w" src="https://t1.daumcdn.net/cfile/tistory/2327BB39578FA96F05" style="max-width:100%;height:auto" width="640" height="338" filename="Microsoft-Excel-Logo.png" filemime="image/png"></span></p><p style="line-height: 1.5;"><span style="font-size: 12pt;"><br></span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">하지만 시간에 만들었던 엑셀은 아직 엑셀이라 하기에는 기능이 조금 부족하였습니다. 실제 엑셀을 살펴보자면 셀에 문자열만 넣을 수 있는 것이 아니라 숫자 데이터도 넣을 수 있고 날짜도 넣을 수 있고, 심지어는 수식도 넣어서 연산 까지 할 수 있는 만능 셀입니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"></p><table style="WIDTH: 634px; BORDER-COLLAPSE: collapse; HEIGHT: 31px" cellspacing="1" cellpadding="1" bgcolor="#ffffff">
<tbody>
<tr>
<td style="BORDER-BOTTOM: rgb(48,88,210) 1px solid; BORDER-LEFT: rgb(48,88,210) 0px solid; BORDER-TOP: rgb(48,88,210) 0px solid; BORDER-RIGHT: rgb(48,88,210) 0px solid" bgcolor="#3058d2" width="1%"><span style="FONT-SIZE: 10pt"><span style="FONT-FAMILY: Gulim"><span style="font-weight: bold; font-size: 12pt;">&nbsp;</span></span></span></td>
<td style="BORDER-BOTTOM: rgb(48,88,210) 1px solid; BORDER-LEFT: rgb(48,88,210) 0px solid; BORDER-TOP: rgb(48,88,210) 0px solid; BORDER-RIGHT: rgb(48,88,210) 0px solid" width="99%"><span style="COLOR: rgb(48,88,210); FONT-SIZE: 10pt"><span style="FONT-FAMILY: Gulim"><span style="font-weight: bold; font-size: 12pt;">&nbsp;Cell 클래스 확장</span></span></span><font color="#c8056a"><strong><span style="FONT-SIZE: 10pt"><span style="FONT-FAMILY: Gulim"><br><span style="font-size: 12pt;">
</span></span></span></strong></font></td>
<td style="BORDER-BOTTOM: rgb(255,70,197) 1px solid; BORDER-LEFT: rgb(48,88,210) 0px solid; BORDER-TOP: rgb(48,88,210) 0px solid; BORDER-RIGHT: rgb(48,88,210) 0px solid" width="100%"><span style="FONT-SIZE: 10pt"><span style="font-family: Gulim; font-size: 12pt;">&nbsp;</span></span></td></tr></tbody></table><br><span style="font-size: 12pt;">

</span><p></p><div style="line-height: 1.5;"></div><p style="line-height: 1.5;"><span style="font-size: 12pt;">
</span></p><div style="line-height: 1.5;"></div><p style="line-height: 1.5;"><br><span style="font-size: 12pt;">앞서 말했듯이, Cell 클래스에는 string 데이터만 저장할 수 있기 때문에 이를 상속 받는 클래스들을 만들어서 셀에 다양한 데이터들을 보관할 수 있게 할 것입니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span style="font-size: 12pt;">class Cell</span></p><p></p><p><span style="font-size: 12pt;">{</span></p><p><span style="font-size: 12pt;">protected:</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">int x, y;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">Table* table;</span></p><p><br></p><p><span style="font-size: 12pt;">public:</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">virtual string stringify() = 0;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">virtual int to_numeric() = 0;</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">Cell(int x, int y, Table* table);</span></p><p><span style="font-size: 12pt;">};</span></p></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">일단 기존의 Cell 클래스에서 문자열 데이터를 보관했던 것과는 달리 아예 그 항목을 빼버리고, 이를 상속 받는 클래스에서 데이터를 보관하도록 하였습니다. 또한, stringify 함수와 to_numeric 을 순수 가상 함수로 정의해서 이를 상속 받는 클래스에서 이 함수들을 반드시 구현 토록 하였습니다.</span></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span style="font-size: 12pt;">class StringCell : public Cell</span></p><p><span style="font-size: 12pt;">{</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">string data;</span></p><p><span style="font-size: 12pt;">public:</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">string stringify();</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">int to_numeric();</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">StringCell(string data, int x, int y, Table* t);</span></p><p><span style="font-size: 12pt;">};</span></p><p><span style="font-size: 12pt;">class NumberCell : public Cell</span></p><p><span style="font-size: 12pt;">{</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">int data;</span></p><p><span style="font-size: 12pt;">public:</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">string stringify();</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">int to_numeric();</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">NumberCell(int data, int x, int y, Table* t);</span></p><p><span style="font-size: 12pt;">};</span></p><p><span style="font-size: 12pt;">class DateCell : public Cell</span></p><p><span style="font-size: 12pt;">{</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">time_t data;</span></p><p><span style="font-size: 12pt;">public:</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">string stringify();</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">int to_numeric();</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">DateCell(string s, int x, int y, Table* t);</span></p><p><span style="font-size: 12pt;">};</span></p><p><br></p></div><p style="line-height: 1.5;"><span style="font-size: 12pt;"><br></span></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">일단 위 셋은 각각 문자열, 정수, 시간 정보를 보관하는 클래스들 입니다. 사실 이들을 구현하는 것은 그렇게 어렵지 않습니다. 단순히 데이터를 문자열이나 정수 형으로 바꾸기만 해주면 되기 때문이지요. 참고로 DateCell 의 경우에는 편의를 위해서 yyyy-mm-dd 형식으로만 입력을 받는 것으로 정하였습니다.그 결과 다음과 같습니다.</span></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span style="font-size: 12pt;">Cell::Cell(int x, int y, Table* table) : x(x), y(y), table(table) { }</span></p><p><br></p><p><span style="font-size: 12pt;">StringCell::StringCell(string data, int x, int y, Table* t) : data(data), Cell(x, y, t) {}</span></p><p><span style="font-size: 12pt;">string StringCell::stringify() {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">return data;</span></p><p><span style="font-size: 12pt;">}</span></p><p><span style="font-size: 12pt;">int StringCell::to_numeric() {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">return 0;</span></p><p><span style="font-size: 12pt;">}</span></p><p><br></p><p><span style="font-size: 12pt;">/*</span></p><p><br></p><p><span style="font-size: 12pt;">NumberCell</span></p><p><br></p><p><span style="font-size: 12pt;">*/</span></p><p><span style="font-size: 12pt;">NumberCell::NumberCell(int data, int x, int y, Table* t) : data(data), Cell(x, y, t) {}</span></p><p><br></p><p><span style="font-size: 12pt;">string NumberCell::stringify() {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">return to_string(data);</span></p><p><span style="font-size: 12pt;">}</span></p><p><span style="font-size: 12pt;">int NumberCell::to_numeric() {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">return data;</span></p><p><span style="font-size: 12pt;">}</span></p><p><br></p><p><span style="font-size: 12pt;">/*</span></p><p><br></p><p><span style="font-size: 12pt;">DateCell</span></p><p><br></p><p><span style="font-size: 12pt;">*/</span></p><p><span style="font-size: 12pt;">string DateCell::stringify() {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">char buf[50];</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">tm temp;&nbsp;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">localtime_s(&amp;temp, &amp;data);</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">strftime(buf, 50, "%F", &amp;temp);</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">return string(buf);</span></p><p><span style="font-size: 12pt;">}</span></p><p><span style="font-size: 12pt;">int DateCell::to_numeric() {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">return static_cast&lt;int&gt;(data);</span></p><p><span style="font-size: 12pt;">}</span></p><p><br></p><p><span style="font-size: 12pt;">DateCell::DateCell(string s, int x, int y, Table* t) : Cell(x, y, t) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">// 입력받는 Date 형식은 항상 yyyy-mm-dd 꼴이라 가정한다.</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">int year = atoi(s.c_str());</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">int month = atoi(s.c_str() + 5);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">int day = atoi(s.c_str() + 8);</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">tm timeinfo;</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">timeinfo.tm_year = year - 1900;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">timeinfo.tm_mon = month - 1;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">timeinfo.tm_mday = day;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">timeinfo.tm_hour = 0;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">timeinfo.tm_min = 0;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">timeinfo.tm_sec = 0;</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">data = mktime(&amp;timeinfo);</span></p><p><span style="font-size: 12pt;">}</span></p><div><br></div></div><div style="line-height: 1.5;"><span style="font-size: 12pt;"><br></span></div><div style="line-height: 1.5;"><span style="font-size: 12pt;">참고로 DateCell 의 경우 구현이 조금 복잡한데 자세히 살펴보도록 하겠습니다.&nbsp;</span><br><br></div><div style="line-height: 1.5;"><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; background-color: rgb(219, 232, 251);"><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">// 입력받는 Date 형식은 항상 yyyy-mm-dd 꼴이라 가정한다.</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">int year = atoi(s.c_str());</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">int month = atoi(s.c_str() + 5);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">int day = atoi(s.c_str() + 8);</span></p></div><p><br></p><p><span style="font-size: 12pt;">일단 위 처럼 입력 받은 문자열을 연도, 월, 일로 구분하게 됩니다.&nbsp;</span></p><p><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; background-color: rgb(219, 232, 251);"><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">tm timeinfo;</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">timeinfo.tm_year = year - 1900;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">timeinfo.tm_mon = month - 1;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">timeinfo.tm_mday = day;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">timeinfo.tm_hour = 0;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">timeinfo.tm_min = 0;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">timeinfo.tm_sec = 0;</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">data = mktime(&amp;timeinfo);</span></p></div></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">이를 바탕으로 timeinfo 객체를 초기화 합니다. tm 클래스는&nbsp;일월년 시분초 단위로 데이터를 보관하는 클래스 입니다. 하지만 우리의 DateCell 은 time_t 형태로 데이터를 보관하고 있는데 그 변환을 위해 mktime 에 timeinfo 를 전달하면 변환할 수 있습니다. 참고로 time_t 타입은 1970년 부터 현재 시간 까지 몇 초가 흘렀는지 보관하는 정수형 변수라고 생각하시면 됩니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span style="font-size: 12pt;">class ExprCell : public Cell {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">string data;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">string* parsed_expr;</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">Vector exp_vec;</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">// 연산자 우선 순위를 반환합니다.&nbsp;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">int precedence(char c);</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">// 수식을 분석합니다.&nbsp;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">void parse_expression();</span></p><p><br></p><p><span style="font-size: 12pt;">public:</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">ExprCell(string data, int x, int y, Table* t);</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">string stringify();</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">int to_numeric();</span></p><p><span style="font-size: 12pt;">};</span></p><p><br></p></div><p style="line-height: 1.5;"><span style="font-size: 12pt;"><br></span></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">그렇다면 이제 대망의 ExprCell 을 살펴볼 차례입니다. 일단 to_numeric() 에 다 넣을 수 없어서 두 개의 함수를 새로 만들었습니다. precedence 함수는 입력받은 연산자의 우선순위를 반환하고, parse_expression 함수는 수식을 분석해서 계산하기 편하게 해주는 함수 입니다. 계산하기 편하게 한다는게 무슨 말이냐고요? 아래를 봐주시기 바랍니다.</span><br></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"></p><table style="WIDTH: 634px; BORDER-COLLAPSE: collapse; HEIGHT: 31px" cellspacing="1" cellpadding="1" bgcolor="#ffffff">
<tbody>
<tr>
<td style="BORDER-BOTTOM: rgb(48,88,210) 1px solid; BORDER-LEFT: rgb(48,88,210) 0px solid; BORDER-TOP: rgb(48,88,210) 0px solid; BORDER-RIGHT: rgb(48,88,210) 0px solid" bgcolor="#3058d2" width="1%"><span style="FONT-SIZE: 10pt"><span style="FONT-FAMILY: Gulim"><span style="font-weight: bold; font-size: 12pt;">&nbsp;</span></span></span></td>
<td style="BORDER-BOTTOM: rgb(48,88,210) 1px solid; BORDER-LEFT: rgb(48,88,210) 0px solid; BORDER-TOP: rgb(48,88,210) 0px solid; BORDER-RIGHT: rgb(48,88,210) 0px solid" width="99%"><p><span style="COLOR: rgb(48,88,210); FONT-SIZE: 10pt"><span style="FONT-FAMILY: Gulim"><span style="font-weight: bold; font-size: 12pt;">&nbsp;수식 계산하기 - 중위 표기법과 후위 표기법</span></span></span><font color="#c8056a"><strong><span style="FONT-SIZE: 10pt"><span style="FONT-FAMILY: Gulim"><br><span style="font-size: 12pt;">
</span></span></span></strong></font></p></td>
<td style="BORDER-BOTTOM: rgb(255,70,197) 1px solid; BORDER-LEFT: rgb(48,88,210) 0px solid; BORDER-TOP: rgb(48,88,210) 0px solid; BORDER-RIGHT: rgb(48,88,210) 0px solid" width="100%"><span style="FONT-SIZE: 10pt"><span style="font-family: Gulim; font-size: 12pt;">&nbsp;</span></span></td></tr></tbody></table><br><span style="font-size: 12pt;">

</span><p></p><div style="line-height: 1.5;"></div><p style="line-height: 1.5;"><span style="font-size: 12pt;">
</span></p><div style="line-height: 1.5;"></div><p style="line-height: 1.5;"><span style="font-size: 12pt;">우리는 흔히 수식을 나타내기 위해 다음과 같이 써 왔습니다.</span></p><p style="line-height: 1.5;"><span style="font-size: 12pt;"><br></span></p><div class="txc-textbox" style="border: 1px solid rgb(159, 211, 49); padding: 10px; line-height: 1.5; background-color: rgb(231, 253, 181);"><p style="text-align: center;"><span style="font-size: 12pt;">3 + 4 * 5 + 4&nbsp;* (7 - 2)</span></p></div><p style="line-height: 1.5;"><span style="font-size: 12pt;"><br></span></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">이렇게 표기하는 방식을 중위 표기법이라고 합니다. 사실 우리는 위 방식에 익숙해서 어떠한 순서로 계산하는지 쉽게 알 수 있지만 컴퓨터에 경우 이를 계산하는데 조금 어려울 수 있습니다. 일단 고려해야할 점들이 먼저 괄호를 우선으로 계산하고, 그 다음에 * 와 / , 그리고 + 와 - 의 우선 순위로 나누어서 계산해야 합니다.</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">쉽게 말해 위 수식의 경우 비록 맨 앞에 3 + 4 이 있지만 사실은&nbsp;4 * 5 를 먼저 계산해야 됩니다. 즉,&nbsp;컴퓨터가 이 수식을 계산하기 위해서는 </span><b><span style="font-size: 12pt;">계산하는 위치를 우선 순위에 맞게 이러 저리 옮겨다녀야 합니다.</span></b></p><div class="google-auto-placed ap_container" style="text-align: center; width: 100%; height: auto; clear: none;"><ins data-ad-format="auto" class="adsbygoogle adsbygoogle-noablate" data-ad-client="ca-pub-6608926154840997" data-adsbygoogle-status="done" style="display: block; margin: auto; background-color: transparent;"><ins id="aswift_5_expand" style="display: inline-table; border: none; height: 0px; margin: 0px; padding: 0px; position: relative; visibility: visible; width: 730px; background-color: transparent;"><ins id="aswift_5_anchor" style="display: block; border: none; height: 0px; margin: 0px; padding: 0px; position: relative; visibility: visible; width: 730px; background-color: transparent; overflow: hidden; opacity: 0;"><iframe width="730" height="183" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_5" name="aswift_5" style="left:0;position:absolute;top:0;width:730px;height:183px;"></iframe></ins></ins></ins></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">위 처럼 피연산자와 피연산자 사이에 연산자를 넣는 형태로 수식을 표현하는 방법을 중위 표기법(infix notation) 이라고 부릅니다. 쉽게 말해 연산자가 '중간' 에 들어가서 중위 표기법이지요.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">반면에 아래의 수식을 살펴보도록 합시다.</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"></p><div class="txc-textbox" style="border: 1px solid rgb(159, 211, 49); padding: 10px; line-height: 1.5; background-color: rgb(231, 253, 181);"><p style="text-align: center;"><span style="font-size: 12pt;">3&nbsp;4 5 * + 4 7 2 - * +</span></p></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">우리가 흔히 생각하는 수식의 모습이랑 사뭇 다릅니다. 사실 위 수식은 앞서 말한 수식과 정확히 동일한 수식인데, 그 표현 방식이 다를 뿐입니다. <b>이러한 형태로 수식을 표현하는 방식을 후위 표기법(postfix notation) </b>이라고 합니다.&nbsp;자세히 보자면 이전 수식과 다른 점을 두 가지 찾을 수 있는데, 하나는 이전과는 달리 연산자들이 피연산자 뒤쪽에 위치해 있다는 점과, 또 하나는 괄호가 사라졌다는 점입니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">괄호가 사라졌다는 것이 무슨 의미가 있을까요?</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">기존의 중위 표현법이 컴퓨터가 해석하기에 불편했었던 점이 바로 연산자의 우선 순위나 괄호에 따라 이리 저리 계산하는 부분을 찾아다녀야 했던 점이었습니다<b>. 하지만 후위 표기법에서는 놀랍게도 이리 저리 계산할 위치를 찾으러 돌아다닐 필요 없이,&nbsp;읽어들이는 순서 대로 계산을 쭉 할 수 있습니다</b></span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">물론 사람이 보기에는 조금 불편하지만 컴퓨터의 입장에서는, 즉 프로그래머의 입장에서는 코딩하기에 매우 편리한 표기 방법 입니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">그렇다면 이 후위 표기법으로 표현된 식을 컴퓨터가 어떻게 해석하는지 살펴보겠습니다. 컴퓨터는 아래와 같은 과정으로 위 후위 표기법으로 변환된 식을 계산합니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><ol style="list-style-type: decimal;"><li style="line-height: 1.5;"><span style="font-size: 12pt;">피연산자를 만나면 스택에 push 합니다.</span></li><li style="line-height: 1.5;"><span style="font-size: 12pt;">연산자를 만나면 스택에서 두 개를 pop 한 뒤에 그 둘에 해당 연산을 한 후, 그 결과를 다시 스택에 push 합니다.</span></li></ol><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">이와 같은 방식으로 위 수식을 계산해보도록 하겠습니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><p style="text-align: center; clear: none; float: none; line-height: 1.5;"><span class="imageblock" style="display:inline-block;width:576px;;height:auto;max-width:100%"><img srcset="//img1.daumcdn.net/thumb/R1920x0/?fname=http%3A%2F%2Fcfile22.uf.tistory.com%2Fimage%2F24246334578EC0EE1DABA0 1920w, //img1.daumcdn.net/thumb/R960x0/?fname=http%3A%2F%2Fcfile22.uf.tistory.com%2Fimage%2F24246334578EC0EE1DABA0 960w, //img1.daumcdn.net/thumb/R720x0/?fname=http%3A%2F%2Fcfile22.uf.tistory.com%2Fimage%2F24246334578EC0EE1DABA0 720w, //img1.daumcdn.net/thumb/R640x0.q70/?fname=http%3A%2F%2Fcfile22.uf.tistory.com%2Fimage%2F24246334578EC0EE1DABA0 640w, //img1.daumcdn.net/thumb/R480x0.q70/?fname=http%3A%2F%2Fcfile22.uf.tistory.com%2Fimage%2F24246334578EC0EE1DABA0 480w" src="https://t1.daumcdn.net/cfile/tistory/24246334578EC0EE1D" style="max-width:100%;height:auto" width="576" height="3148" filename="8.2.1.png" filemime="image/png"></span></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">실제로 3 + 4 * 5 + 4&nbsp;* (7 - 2) 을 계산 했을 때와 그 결과가 같음을 알 수 있습니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">이를 바탕으로 후위 표기법으로 된 수식을 계산하는 is_numeric 함수를 살펴보도록 하겠습니다.</span></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span style="font-size: 12pt;">int ExprCell::to_numeric() {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">double result = 0;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">NumStack stack;</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">for (int i = 0; i &lt; exp_vec.size(); i++) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">string s = exp_vec[i];</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">// 셀 일 경우</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">if (isalpha(s[0])) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">stack.push(table-&gt;to_numeric(s));</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">// 숫자 일 경우 (한 자리라 가정)</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">else if (isdigit(s[0])) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">stack.push(atoi(s.c_str()));</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">else {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">double y = stack.pop();</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">double x = stack.pop();</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">switch (s[0]) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">case '+':</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">stack.push(x + y);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">break;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">case '-':</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">stack.push(x - y);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">break;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">case '*':</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">stack.push(x * y);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">break;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">case '/':</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">stack.push(x / y);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">break;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">return stack.pop();</span></p><p><span style="font-size: 12pt;">}</span></p></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">일단 우리는 parse_expression 함수를 통해서 입력 받은 중위 표기법으로 되어 있는 수식이, 후위 표기법으로 변환되어 있고, 그 결과가 exp_vec 에 저장되어 있다고 생각해봅시다. exp_vec 은 벡터 클래스 객체로, 각각의 원소가 후위 표기법으로 변환된 수식의 각각의 토큰이 됩니다. 즉, 앞선 예제의 경우 exp_vec 은 3, 4, 5, *, +, 4, 7, 2, -, *, + 으로 이루어진 배열 이라 보시면 됩니다.</span></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span style="font-size: 12pt;">string s = exp_vec[i];</span></p></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">따라서 위와 같이 for 문을 통해 각각의 토큰(exp_vec 의 각 원소들)에 접근할 수 있습니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">// 셀 일 경우</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">if (isalpha(s[0])) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">stack.push(table-&gt;to_numeric(s));</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">// 숫자 일 경우 (한 자리라 가정)</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">else if (isdigit(s[0])) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">stack.push(atoi(s.c_str()));</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">그리고 각각의 토큰에 대해서, 셀 이름 (A3, B2 이렇게) 이나 숫자일 경우 스택에 push 하게 됩니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">else {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">double y = stack.pop();</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">double x = stack.pop();</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">switch (s[0]) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">case '+':</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">stack.push(x + y);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">break;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">case '-':</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">stack.push(x - y);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">break;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">case '*':</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">stack.push(x * y);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">break;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">case '/':</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">stack.push(x / y);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">break;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">아니면 연산자를 만날 경우 스택에서 두 번 pop 을 해서 해당하는 피연산자들에 해당 연산자를 적용해서 다시 스택에 push 하게 됩니다.&nbsp;</span></p><p style="line-height: 1.5;"><span style="font-size: 12pt;"><br></span></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">return stack.pop();</span></p></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">그리고 모든 계산이 끝나면 스택에 최종 결과값을 pop 하며 이를 리턴하게 됩니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">자 그럼 이제 우리가 해야할 일은&nbsp;중위 표기법으로 표기된 수식을 후위 표기법으로 변환하는 작업만 수행하면 됩니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"></p><table style="WIDTH: 634px; BORDER-COLLAPSE: collapse; HEIGHT: 31px" cellspacing="1" cellpadding="1" bgcolor="#ffffff">
<tbody>
<tr>
<td style="BORDER-BOTTOM: rgb(48,88,210) 1px solid; BORDER-LEFT: rgb(48,88,210) 0px solid; BORDER-TOP: rgb(48,88,210) 0px solid; BORDER-RIGHT: rgb(48,88,210) 0px solid" bgcolor="#3058d2" width="1%"><span style="FONT-SIZE: 10pt"><span style="FONT-FAMILY: Gulim"><span style="font-weight: bold; font-size: 12pt;">&nbsp;</span></span></span></td>
<td style="BORDER-BOTTOM: rgb(48,88,210) 1px solid; BORDER-LEFT: rgb(48,88,210) 0px solid; BORDER-TOP: rgb(48,88,210) 0px solid; BORDER-RIGHT: rgb(48,88,210) 0px solid" width="99%"><p><strong><span style="font-size: 10pt;"><span style="font-family: Gulim;"><font color="#3058d2"><span style="font-size: 12pt;">&nbsp;중위 표기법을 후위 표기법으로 변환하기 (parse_expression 함수)</span></font></span></span></strong></p></td>
<td style="BORDER-BOTTOM: rgb(255,70,197) 1px solid; BORDER-LEFT: rgb(48,88,210) 0px solid; BORDER-TOP: rgb(48,88,210) 0px solid; BORDER-RIGHT: rgb(48,88,210) 0px solid" width="100%"><span style="FONT-SIZE: 10pt"><span style="font-family: Gulim; font-size: 12pt;">&nbsp;</span></span></td></tr></tbody></table><br><span style="font-size: 12pt;">

</span><p></p><div style="line-height: 1.5;"></div><p style="line-height: 1.5;"><span style="font-size: 12pt;">
</span></p><div style="line-height: 1.5;"></div><p style="line-height: 1.5;"><br><span style="font-size: 12pt;">중위 표기법을 후위 표기법으로 변환하는 것은 다음의 방식을 따릅니다.</span><br></p><p style="line-height: 1.5;"><br></p><ol style="list-style-type: decimal;"><li style="line-height: 1.5;"><span style="font-size: 12pt;">피연산자 (셀 이름이나 숫자) 일 경우 그냥 exp_vec 에&nbsp;넣습니다.&nbsp;</span></li><li style="line-height: 1.5;"><span style="font-size: 12pt;">여는 괄호( (, [, { 와 같은 것들 ) 을 만날 경우 스택에 push 합니다.</span></li><li style="line-height: 1.5;"><span style="font-size: 12pt;">닫는 괄호( ), ], } 와 같은 것들 ) 을 만날 경우 여는 괄호가 pop 될 때 까지 pop 되는 연산자들을 exp_vec 에 넣습니다.</span></li><li style="line-height: 1.5;"><span style="font-size: 12pt;">연산자일 경우 자기 보다 우선순위가 낮은 연산자가 스택 최상단에 올 때 까지 (혹은 스택이 빌 때 까지)&nbsp;스택을 pop 하고 (낮은 것은 pop 하지 않습니다), pop 된 연산자들을 exp_vec 에 넣습니다. 그리고 마지막에 자신을 스택에 push 합니다.&nbsp;</span></li></ol><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">그리고 연산자들의 우선 순위는 아래의 함수에 의해 정의됩니다.</span></p><p style="line-height: 1.5;"><span style="font-size: 12pt;"><br></span></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span style="font-size: 12pt;">int ExprCell::precedence(char c) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">switch (c) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">case '(':</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">case '[':</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">case '{':</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">return 0;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">case '+':</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">case '-':</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">return 1;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">case '*':</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">case '/':</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">return 2;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">return 0;</span></p><p><span style="font-size: 12pt;">}</span></p></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">괄호들이 가장 낮고, 그 다음이 + 와 -, 그리고 최상위 우선순위가 * 와 / 입니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">그렇다면 3 + 4 * 5 + 4&nbsp;* (7 - 2) 가 어떻게 변환되는지 그림으로 살펴보도록 하겠습니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><p style="text-align: center; clear: none; float: none; line-height: 1.5;"><span class="imageblock" style="display:inline-block;width:576px;;height:auto;max-width:100%"><img srcset="//img1.daumcdn.net/thumb/R1920x0/?fname=http%3A%2F%2Fcfile27.uf.tistory.com%2Fimage%2F2779ED44578F2D81123CD3 1920w, //img1.daumcdn.net/thumb/R960x0/?fname=http%3A%2F%2Fcfile27.uf.tistory.com%2Fimage%2F2779ED44578F2D81123CD3 960w, //img1.daumcdn.net/thumb/R720x0/?fname=http%3A%2F%2Fcfile27.uf.tistory.com%2Fimage%2F2779ED44578F2D81123CD3 720w, //img1.daumcdn.net/thumb/R640x0.q70/?fname=http%3A%2F%2Fcfile27.uf.tistory.com%2Fimage%2F2779ED44578F2D81123CD3 640w, //img1.daumcdn.net/thumb/R480x0.q70/?fname=http%3A%2F%2Fcfile27.uf.tistory.com%2Fimage%2F2779ED44578F2D81123CD3 480w" src="https://t1.daumcdn.net/cfile/tistory/2779ED44578F2D8112" style="max-width:100%;height:auto" width="576" height="3931" filename="8.2.2.png" filemime="image/png"></span></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">이제 위 방식으로 그대로 코드로만 옮기면 됩니다. 여기서는 &nbsp;코딩의 편의를 위해서 사용자가 입력하는 숫자는 1 자리 정수이고, 셀 이름 역시 2자 로 제한하였습니다.&nbsp;이를 확장하는 것은 크게 어렵지 않으니 여러분들이 직접 해보시기 바랍니다.&nbsp;</span><br></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span style="font-size: 12pt;">void ExprCell::parse_expression() {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">Stack stack;&nbsp;</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">// 수식 전체를 () 로 둘러 사서 exp_vec 에 남아있는 연산자들이 push 되게 해줍니다.&nbsp;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">data.insert(0, "(");</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">data.push_back(')');</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">for (int i = 0; i &lt; data.length(); i++) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">if (isalpha(data[i])) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">exp_vec.push_back(data.substr(i, 2));</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">i++;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">else if (isdigit(data[i])) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">exp_vec.push_back(data.substr(i, 1));</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">else if (data[i] == '(' || data[i] == '[' || data[i] == '{') { // Parenthesis</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">stack.push(data.substr(i, 1));</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">else if (data[i] == ')' || data[i] == ']' || data[i] == '}') {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">string t = stack.pop();</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">while (t != "(" &amp;&amp; t != "[" &amp;&amp; t != "{") {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">exp_vec.push_back(t);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">t = stack.pop();</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">else if (data[i] == '+' || data[i] == '-' || data[i] == '*' || data[i] == '/') {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">while (!stack.is_empty() &amp;&amp; precedence(stack.peek()[0]) &gt;= precedence(data[i])) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">exp_vec.push_back(stack.pop());</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">stack.push(data.substr(i, 1));</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">}</span></p><p><span style="font-size: 12pt;">}</span></p></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">위 코드를 보면 변환 알고리즘을 그대로 옮겨놓았다고 생각하면 됩니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">if (isalpha(data[i])) { // 셀 이름의 경우 첫 번째 글자가 알파벳이다.</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">exp_vec.push_back(data.substr(i, 2));</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">i++;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">else if (isdigit(data[i])) { // 첫번째 글자가 숫자라면 정수 데이터</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">exp_vec.push_back(data.substr(i, 1));</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">일단 피연산자를 만날 경우 exp_vec 에 무조건 집어넣으면 됩니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">else if (data[i] == '(' || data[i] == '[' || data[i] == '{') { // Parenthesis</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">stack.push(data.substr(i, 1));</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">else if (data[i] == ')' || data[i] == ']' || data[i] == '}') {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">string t = stack.pop();</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">while (t != "(" &amp;&amp; t != "[" &amp;&amp; t != "{") {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">exp_vec.push_back(t);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">t = stack.pop();</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">반면에 괄호의 경우 여는 괄호를 만나면 스택에 push 하고, 닫는 괄호를&nbsp;만나면 위 처럼 여는 괄호가 스택에서 나올 때 까지 pop 하고, 그 pop 한 연산자들을 벡터에 넣으면 됩니다. 주의할 점은 pop 한 연산자가 괄호일 경우 넣지 않는다는 점입니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">else if (data[i] == '+' || data[i] == '-' || data[i] == '*' || data[i] == '/') {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">while (!stack.is_empty() &amp;&amp; precedence(stack.peek()[0]) &gt;= precedence(data[i])) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">				</span><span style="font-size: 12pt;">exp_vec.push_back(stack.pop());</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">stack.push(data.substr(i, 1));</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">마지막으로 연산자일 경우를 살펴봅시다. peek 의 경우 스택의 최상단 원소를 pop 하지는 않고 무엇인지만 살펴보는 것입니다. 만일 최상단 원소의 우선 순위가 현재 연산자의 우선순위 보다 높다면 이를 스택에서 pop 하고 이를 exp_vec 에 넣어야 겠지요. 위 while 문은 그 과정을 나타내고 있습니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">그리고 맨 마지막에 스택에 현재 연산자를 넣습니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">위 과정을 모두 마치면 후기 표기법으로 변환을 마칠 수 있을 것이라 생각되지만 사실 한 가지 빼먹은 사실이 있습니다. 마지막에 스택에 남아있는 연산자들을 모두 pop 해야 되기 때문이죠. 이를 for 문이 끝난 후에 while 문을 하나 더 넣어서 연산자를 pop 하는 과정을 넣을 수 도 있지만 아래 처럼 좀 더 간단하게 처리할 수 도 있습니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">// 수식 전체를 () 로 둘러 사서 exp_vec 에 남아있는 연산자들이 push 되게 해줍니다.&nbsp;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">data.insert(0, "(");</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">data.push_back(')');</span></p><p><br></p></div><p style="line-height: 1.5;"><span style="font-size: 12pt;"><br></span></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">바로 수식 전체를 ( ) 로 한 번 감싸는 것입니다. 그렇게 된다면 맨 마지막 괄호를 처리하면서 스택에 남아 있던 모든 연산자들이 pop 되겠지요.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">그렇다면 실제로 잘 작동하는지 살펴보도록 합시다.</span></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span style="font-size: 12pt;">// 생략</span></p><p><span style="font-size: 12pt;">int main()</span></p><p><span style="font-size: 12pt;">{</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">TxtTable table(5, 5);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">table.reg_cell(new NumberCell(2, 1, 1, &amp;table), 1, 1);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">table.reg_cell(new NumberCell(3, 1, 2, &amp;table), 1, 2);</span></p><div class="google-auto-placed ap_container" style="text-align: center; width: 100%; height: auto; clear: none;"><ins data-ad-format="auto" class="adsbygoogle adsbygoogle-noablate" data-ad-client="ca-pub-6608926154840997" data-adsbygoogle-status="done" style="display: block; margin: auto; background-color: transparent;"><ins id="aswift_6_expand" style="display: inline-table; border: none; height: 0px; margin: 0px; padding: 0px; position: relative; visibility: visible; width: 708px; background-color: transparent;"><ins id="aswift_6_anchor" style="display: block; border: none; height: 0px; margin: 0px; padding: 0px; position: relative; visibility: visible; width: 708px; background-color: transparent; overflow: hidden; opacity: 0;"><iframe width="708" height="177" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_6" name="aswift_6" style="left:0;position:absolute;top:0;width:708px;height:177px;"></iframe></ins></ins></ins></div><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">table.reg_cell(new NumberCell(4, 2, 1, &amp;table), 2, 1);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">table.reg_cell(new NumberCell(5, 2, 2, &amp;table), 2, 2);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">table.reg_cell(new ExprCell("B2+B3*(C2+C3-2)", 3, 3, &amp;table), 3, 2);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">table.reg_cell(new StringCell("B2 + B3 * ( C2 + C3 - 2 ) = ", 3, 2, &amp;table), 3, 1);</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">cout &lt;&lt; table;</span></p><p><span style="font-size: 12pt;">}</span></p></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">성공적으로 컴파일 하였다면</span></p><p style="line-height: 1.5;"><br></p><p style="text-align: center; clear: none; float: none; line-height: 1.5;"><span class="imageblock" style="display:inline-block;width:488px;;height:auto;max-width:100%"><img srcset="//img1.daumcdn.net/thumb/R1920x0/?fname=http%3A%2F%2Fcfile29.uf.tistory.com%2Fimage%2F274EDE3F578F605425EA74 1920w, //img1.daumcdn.net/thumb/R960x0/?fname=http%3A%2F%2Fcfile29.uf.tistory.com%2Fimage%2F274EDE3F578F605425EA74 960w, //img1.daumcdn.net/thumb/R720x0/?fname=http%3A%2F%2Fcfile29.uf.tistory.com%2Fimage%2F274EDE3F578F605425EA74 720w, //img1.daumcdn.net/thumb/R640x0.q70/?fname=http%3A%2F%2Fcfile29.uf.tistory.com%2Fimage%2F274EDE3F578F605425EA74 640w, //img1.daumcdn.net/thumb/R480x0.q70/?fname=http%3A%2F%2Fcfile29.uf.tistory.com%2Fimage%2F274EDE3F578F605425EA74 480w" src="https://t1.daumcdn.net/cfile/tistory/274EDE3F578F605425" style="max-width:100%;height:auto" width="488" height="268" filename="8.2.3.png" filemime="image/png"></span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">와 같이 잘 작동하고 있음을 알 수 있습니다.</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"></p><table style="WIDTH: 634px; BORDER-COLLAPSE: collapse; HEIGHT: 31px" cellspacing="1" cellpadding="1" bgcolor="#ffffff">
<tbody>
<tr>
<td style="BORDER-BOTTOM: rgb(48,88,210) 1px solid; BORDER-LEFT: rgb(48,88,210) 0px solid; BORDER-TOP: rgb(48,88,210) 0px solid; BORDER-RIGHT: rgb(48,88,210) 0px solid" bgcolor="#3058d2" width="1%"><span style="FONT-SIZE: 10pt"><span style="FONT-FAMILY: Gulim"><span style="font-weight: bold; font-size: 12pt;">&nbsp;</span></span></span></td>
<td style="BORDER-BOTTOM: rgb(48,88,210) 1px solid; BORDER-LEFT: rgb(48,88,210) 0px solid; BORDER-TOP: rgb(48,88,210) 0px solid; BORDER-RIGHT: rgb(48,88,210) 0px solid" width="99%"><p><span style="COLOR: rgb(48,88,210); FONT-SIZE: 10pt"><span style="FONT-FAMILY: Gulim"><span style="font-weight: bold; font-size: 12pt;">&nbsp;엑셀 프로그램</span></span></span><font color="#c8056a"><strong><span style="FONT-SIZE: 10pt"><span style="FONT-FAMILY: Gulim"><br><span style="font-size: 12pt;">
</span></span></span></strong></font></p></td>
<td style="BORDER-BOTTOM: rgb(255,70,197) 1px solid; BORDER-LEFT: rgb(48,88,210) 0px solid; BORDER-TOP: rgb(48,88,210) 0px solid; BORDER-RIGHT: rgb(48,88,210) 0px solid" width="100%"><span style="FONT-SIZE: 10pt"><span style="font-family: Gulim; font-size: 12pt;">&nbsp;</span></span></td></tr></tbody></table><br><span style="font-size: 12pt;">

</span><p></p><div style="line-height: 1.5;"></div><p style="line-height: 1.5;"><span style="font-size: 12pt;">
</span></p><div style="line-height: 1.5;"></div><p style="line-height: 1.5;"><br><span style="font-size: 12pt;">그렇다면 이제 실제로 사용자의 입력을 받아서 비록 마우스는 쓸 수 없더라도 키보드로 명령을 처리하는 엑셀 프로그램을 만들어보도록 하겠습니다.&nbsp;</span><br></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span style="font-size: 12pt;">class Excel</span></p><p></p><p><span style="font-size: 12pt;">{</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">Table* current_table;</span></p><p><br></p><p><span style="font-size: 12pt;">public:</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">Excel(int max_row, int max_col, int choice);</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">int parse_user_input(string s);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">void command_line();</span></p><p><span style="font-size: 12pt;">};</span></p></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">위 클래스는 사용자의 입력을 받아서 실제 테이블을 생성하고 이를 관리해주는 클래스 입니다. 또한 parse_user_input 함수의 경우 사용자의 입력을 인자로 받아서, 이를 처리하는 역할을 수행합니다.</span></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span style="font-size: 12pt;">Excel::Excel(int max_row, int max_col, int choice = 0) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">switch (choice) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">case 0:</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">current_table = new TxtTable(max_row, max_col);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">break;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">case 1:</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">current_table = new CSVTable(max_row, max_col);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">break;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">default:</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">current_table = new HtmlTable(max_row, max_col);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">}</span></p><p><span style="font-size: 12pt;">}</span></p></div><p style="line-height: 1.5;"><span style="font-size: 12pt;"><br></span></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">위는 Excel 객체의 생성자로 어떠한 형태의 테이블을 형성할 지 결정합니다.</span></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span style="font-size: 12pt;">int Excel::parse_user_input(string s) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">int next = 0;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">string command = "";</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">for (int i = 0; i &lt; s.length(); i++) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">if (s[i] == ' ') {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">command = s.substr(0, i);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">next = i + 1;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">break;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">else if (i == s.length() - 1) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">command = s.substr(0, i + 1);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">next = i + 1;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">break;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">}</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">string to = "";</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">for (int i = next; i &lt; s.length(); i++) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">if (s[i] == ' ' || i == s.length() - 1) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">to = s.substr(next, i - next);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">next = i + 1;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">break;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">else if (i == s.length() - 1) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">to = s.substr(0, i + 1);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">next = i + 1;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">			</span><span style="font-size: 12pt;">break;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">}</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">// Cell 이름으로 받는다.&nbsp;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">int col = to[0] - 'A';</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">int row = atoi(to.c_str() + 1) - 1;</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">string rest = s.substr(next);</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">if (command == "sets") {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">current_table-&gt;reg_cell(new StringCell(rest, row, col, current_table), row, col);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">else if (command == "setn") {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">current_table-&gt;reg_cell(new NumberCell(atoi(rest.c_str()), row, col, current_table), row, col);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">else if (command == "setd") {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">current_table-&gt;reg_cell(new DateCell(rest, row, col, current_table), row, col);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">else if (command == "sete") {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">current_table-&gt;reg_cell(new ExprCell(rest, row, col, current_table), row, col);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">else if (command == "out") {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">ofstream out(to);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">out &lt;&lt; *current_table;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">cout &lt;&lt; to &lt;&lt; " 에 내용이 저장되었습니다" &lt;&lt; endl;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">}</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">else if (command == "exit") {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">return 0;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">}</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">return 1;</span></p><p><span style="font-size: 12pt;">}</span></p></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">그리고 parse_user_input 함수는 사용자의 입력을 받아서 적절한 명령을 처리하게 됩니다. 예를 들어서</span></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(243, 197, 52); padding: 10px; line-height: 1.5; background-color: rgb(254, 254, 184);"><p><span style="font-size: 12pt;">setn A1 10</span></p></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">이렇게 치면, A1 셀을 NumberCell 로 생성하며, 10 의 값으로 초기화 시켜줍니다.</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">혹은&nbsp;</span></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(243, 197, 52); padding: 10px; line-height: 1.5; background-color: rgb(254, 254, 184);"><p><span style="font-size: 12pt;">sets B2 hello world!</span></p></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">의 경우 B2 셀을 StringCell 로 생성하며 "hello world!" 로 초기화 시켜줍니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">날짜와 수식의 경우도 마찬가지이며, 각각 setd 와 sete 의 명령어를 사용하고 있습니다. 그 외에도, out 을 통해서 원하는 파일에 출력할 수 도 있고, exit 를 하면 프로그램을 종료할 수 있습니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><div class="txc-textbox" style="border: 1px solid rgb(121, 165, 228); padding: 10px; line-height: 1.5; background-color: rgb(219, 232, 251);"><p><span style="font-size: 12pt;">void Excel::command_line() {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">string s;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">getline(cin, s);</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">while (parse_user_input(s)) {</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">cout &lt;&lt; *current_table &lt;&lt; endl &lt;&lt; "&gt;&gt; ";</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">		</span><span style="font-size: 12pt;">getline(cin, s);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">}</span></p><p><span style="font-size: 12pt;">}</span></p><p><span style="font-size: 12pt;">int main()</span></p><p><span style="font-size: 12pt;">{</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">cout &lt;&lt; "테이블 (타입) (최대 행 크기) (최대 열 크기) 를 순서대로 입력해주세요" &lt;&lt; endl;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">cout &lt;&lt; "* 참고 * " &lt;&lt; endl;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">cout &lt;&lt; "1 : 텍스트 테이블, 2 : CSV 테이블, 3 : HTML 테이블" &lt;&lt; endl;</span></p><p><br></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">int type, max_row, max_col;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">cin &gt;&gt; type &gt;&gt; max_row &gt;&gt; max_col;</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">Excel m(max_row, max_col, type - 1);</span></p><p><span class="Apple-tab-span" style="white-space: pre; font-size: 12pt;">	</span><span style="font-size: 12pt;">m.command_line();</span></p><p><span style="font-size: 12pt;">}</span></p></div><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">마지막으로 command_line 함수는 사용자의 입력을 계속 기다리면서 내용이 업데이트 될 때 마다 화면에 표를 출력해주게 됩니다. 실제로 사용하는 예시는 아래와 같습니다.&nbsp;</span></p><p style="line-height: 1.5;"><br></p><p style="text-align: center; clear: none; float: none; line-height: 1.5;"><span class="imageblock" style="display:inline-block;width:366px;;height:auto;max-width:100%"><img srcset="//img1.daumcdn.net/thumb/R1920x0/?fname=http%3A%2F%2Fcfile24.uf.tistory.com%2Fimage%2F265A9C33578FA1FC0BD04C 1920w, //img1.daumcdn.net/thumb/R960x0/?fname=http%3A%2F%2Fcfile24.uf.tistory.com%2Fimage%2F265A9C33578FA1FC0BD04C 960w, //img1.daumcdn.net/thumb/R720x0/?fname=http%3A%2F%2Fcfile24.uf.tistory.com%2Fimage%2F265A9C33578FA1FC0BD04C 720w, //img1.daumcdn.net/thumb/R640x0.q70/?fname=http%3A%2F%2Fcfile24.uf.tistory.com%2Fimage%2F265A9C33578FA1FC0BD04C 640w, //img1.daumcdn.net/thumb/R480x0.q70/?fname=http%3A%2F%2Fcfile24.uf.tistory.com%2Fimage%2F265A9C33578FA1FC0BD04C 480w" src="https://t1.daumcdn.net/cfile/tistory/265A9C33578FA1FC0B" style="max-width:100%;height:auto" width="366" height="506" filename="8.2.4.png" filemime="image/png"></span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">이상으로 위와 같이 나만의 미니 엑셀을 완성하였습니다!</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">사실 앞서 쭉 이야기 해 왔지만 제가 구현한 미니 엑셀은 코딩의 간소화를 위해서 몇 가지 제약들이 있습니다. 이러한 부분은 여러분들이 자유롭게 코딩하면서 더 확장 해 나가셨으면 좋겠습니다.</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"></p><table style="WIDTH: 634px; BORDER-COLLAPSE: collapse; HEIGHT: 31px" cellspacing="1" cellpadding="1" bgcolor="#ffffff">
<tbody>
<tr>
<td style="BORDER-BOTTOM: rgb(48,88,210) 1px solid; BORDER-LEFT: rgb(48,88,210) 0px solid; BORDER-TOP: rgb(48,88,210) 0px solid; BORDER-RIGHT: rgb(48,88,210) 0px solid" bgcolor="#3058d2" width="1%"><span style="FONT-SIZE: 10pt"><span style="FONT-FAMILY: Gulim"><span style="font-weight: bold; font-size: 12pt;">&nbsp;</span></span></span></td>
<td style="BORDER-BOTTOM: rgb(48,88,210) 1px solid; BORDER-LEFT: rgb(48,88,210) 0px solid; BORDER-TOP: rgb(48,88,210) 0px solid; BORDER-RIGHT: rgb(48,88,210) 0px solid" width="99%"><p><span style="COLOR: rgb(48,88,210); FONT-SIZE: 10pt"><span style="FONT-FAMILY: Gulim"><span style="font-weight: bold; font-size: 12pt;">&nbsp;생각해보기</span></span></span><font color="#c8056a"><strong><span style="FONT-SIZE: 10pt"><span style="FONT-FAMILY: Gulim"><br><span style="font-size: 12pt;">
</span></span></span></strong></font></p></td>
<td style="BORDER-BOTTOM: rgb(255,70,197) 1px solid; BORDER-LEFT: rgb(48,88,210) 0px solid; BORDER-TOP: rgb(48,88,210) 0px solid; BORDER-RIGHT: rgb(48,88,210) 0px solid" width="100%"><span style="FONT-SIZE: 10pt"><span style="font-family: Gulim; font-size: 12pt;">&nbsp;</span></span></td></tr></tbody></table><br><span style="font-size: 12pt;">
</span><span style="font-size: 12pt;">
</span><p></p><div style="line-height: 1.5;"></div><p style="line-height: 1.5;"><span style="font-size: 12pt;">
</span></p><div style="line-height: 1.5;"></div><p style="line-height: 1.5;"><br><span style="font-size: 12pt;">1. ExprCell 의 쉭에서 셀의 이름은 A3 과 같이 단 두 글자만 가능하다는 제약 조건이 있었습니다. 이를 임의의 크기의 이름도 가능하게 확장해보세요. (난이도 : 下)</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">2. 마찬가지로 가능한 숫자도 임의의 길이가 상관없게 확장해보세요. (난이도 : 下)</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">3. 사실&nbsp;</span><span style="font-size: 12pt;">위와 같이 수식을 계산하는 경우 한 가지 문제가 있습니다. 바로 셀들이 서로를 참조할 수 있다는 것입니다. 예를 들어서 A1 = B1 이고 B1 = A1 으로 설정하였다면 B1 의 값을 알기 위해 A1 의 값을 알아야 하고, 그럼 A1 의 값을 알기 위해 B1 의 값을 알아야 하고. .... 와 같은 순환 참조 문제가 발생합니다.</span></p><p style="line-height: 1.5;"><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">따라서 사용자가 타의든 자의든 순환 참조가 있는 식을 입력하였을 때 이를 감지하고 입력을 방지하는 루틴을 제공해야 합니다. (실제 Excel 에서도 순환 참조되는 식을 입력하면 오류가 발생합니다) (난이도 : 上)</span><br><br></p><p style="line-height: 1.5;"><span style="font-size: 12pt;">4. 실제 Excel 의 경우 수식에서 여러가지 함수들을 지원합니다. 여기서도 수식에서 간단한 함수들을 지원하게 해보세요.. (난이도 : 上)</span></p><p style="line-height: 1.5;"><span style="font-size: 12pt;"><br></span></p><p style="line-height: 1.5;"></p><div style="border: 1px solid rgb(254, 137, 67); border-image-source: initial; border-image-slice: initial; border-image-width: initial; border-image-outset: initial; border-image-repeat: initial; padding: 10px; line-height: 1.5; background-color: rgb(254, 222, 199);" class="txc-textbox">
<span style="font-size:12pt;">강좌를 보다가 조금이라도 궁금한 것이나 이상한 점이 있다면 <span style="font-weight: bold;">꼭 댓글을 남겨주시기 바랍니다</span>. 그 외에도 강좌에 관련된 것이라면 어떠한 것도 질문해 주셔도 상관 없습니다. 생각해 볼 문제도 정 모르겠다면 댓글을 달아주세요. </span><br>
<br>
<span style="font-size: 12pt;">현재 여러분이 보신 강좌는<i>&lt;&lt;</i></span><span style="font-size: 16px;"><i>씹어먹는 C++ - &lt;8 - 2. Excel 만들기 프로젝트 2부&gt;</i></span><span style="font-size: 12pt;"><i>&gt;&gt;</i> 입니다. 이번 강좌의 </span><span style="font-size: 12pt; font-weight: bold;">모든 예제들의 코드를 보지 않고 짤 수준까지 강좌를 읽어 보시기 전</span><span style="font-size: 12pt;">까지 다음 강좌로 넘어가지 말아주세요 </span><br>
<br>
<div style="font-size: 12pt; text-align: right;">
<span style="font-size: 12pt;"><a style="font-weight: bold;" title="[http://itguru.tistory.com/notice/15]로 이동합니다." target="_blank" href="http://itguru.tistory.com/135">다음 강좌 보러가기</a><br>
</span>
</div>
</div>
<br><p></p><p></p><div class="container_postbtn"><div class="postbtn_like"><div class="like_btn" data-uoc-svc="tistory" data-uoc-uid="329162_218" data-uoc-sc="401" data-uoc-pcurl="http://itguru.tistory.com/218" data-uoc-fetchurl="http://api.kakao.tistory.com/like/fetch?uid=329162_218"><label class="uoc-icon"><span class="ico_postbtn ico_like"></span> <span class="txt_like uoc-text screen_out">공감</span><span class="txt_like uoc-count">6</span><input type="button" class="inp_btn uoc-button"></label></div><span class="ico_bar"></span><label data-thumbnail-url="http://cfile26.uf.tistory.com/image/2327BB39578FA96F053529" data-title="씹어먹는 C++ - <8 - 2. Excel 만들기 프로젝트 2부>" data-description="이번 강좌에서는 Excel 만들기 프로젝트 완성. 중위 표기법(Infix notation), 후위 표기법(postfix notation) 간의 변환  안녕하세요 여러분. 지난 강좌에 이어서 Excel 만들기 프로젝트를 계속 진행해 보도록 하.." data-profile-image="http://cfile30.uf.tistory.com/image/24672D3F58DB509F14CA8E" data-profile-name="Psi" data-pc-url="http://itguru.tistory.com/218" data-blog-title="Programming IT"><span class="ico_postbtn ico_sns">sns</span><input type="button" class="inp_btn"></label><span class="ico_bar"></span><label data-entry-id="218"><span class="ico_postbtn ico_report">신고</span><input type="button" class="inp_btn"></label></div><div class="postbtn_ccl" data-ccl-type="3"><a href="http://creativecommons.org/licenses/by/4.0/deed.ko" target="_blank" class="link_ccl"><span class="bundle_ccl"><span class="ico_postbtn ico_ccl1">저작자표시</span></span></a></div></div>    <!--
	<rdf:RDF xmlns="http://web.resource.org/cc/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
		<Work rdf:about="">
			<license rdf:resource="http://creativecommons.org/licenses/by-fr/2.0/kr/" />
		</Work>
		<License rdf:about="http://creativecommons.org/licenses/by-fr/">
			<permits rdf:resource="http://web.resource.org/cc/Reproduction"/>
			<permits rdf:resource="http://web.resource.org/cc/Distribution"/>
			<requires rdf:resource="http://web.resource.org/cc/Notice"/>
			<requires rdf:resource="http://web.resource.org/cc/Attribution"/>
			<permits rdf:resource="http://web.resource.org/cc/DerivativeWorks"/>
		</License>
	</rdf:RDF>
	--><div style="text-align:center; padding-top:10px;clear:both">
<iframe src="//www.facebook.com/plugins/like.php?href=http://itguru.tistory.com/218&amp;layout=standard&amp;show_faces=true&amp;width=310&amp;action=like&amp;font=tahoma&amp;colorscheme=light&amp;height=65" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:310px; height:65px;" allowtransparency="true"></iframe>
</div>
<div class="another_category another_category_color_gray">
<h4>'<a href="/category/C++">C++</a>' 카테고리의 다른 글</h4>
<table>
<tbody><tr>
<th>
<a href="/221?category=361027">씹어먹는 C++ - &lt;9 - 2. 템플릿 메타 프로그래밍 (Template Meta programming)&gt;</a>&nbsp;&nbsp;<span>(2)</span>
</th>
<td>
2017.06.26</td>
</tr>
<tr>
<th>
<a href="/219?category=361027">씹어먹는 C++ - &lt;9 - 1. 코드를 찍어내는 틀 - C++ 템플릿(template)&gt;</a>&nbsp;&nbsp;<span>(10)</span>
</th>
<td>
2017.04.07</td>
</tr>
<tr>
<th>
<a href="/218?category=361027" class="current">씹어먹는 C++ - &lt;8 - 2. Excel 만들기 프로젝트 2부&gt;</a>&nbsp;&nbsp;<span>(6)</span>
</th>
<td>
2016.07.19</td>
</tr>
<tr>
<th>
<a href="/217?category=361027">씹어먹는 C++ - &lt;8 - 1. Excel 만들기 프로젝트 1부&gt;</a>&nbsp;&nbsp;<span>(0)</span>
</th>
<td>
2016.07.18</td>
</tr>
<tr>
<th>
<a href="/215?category=361027">씹어먹는 C++ - &lt;7 - 2. C++ 에서 파일 입출력 - ifstream. ofstream, stringstream&gt;</a>&nbsp;&nbsp;<span>(13)</span>
</th>
<td>
2016.07.14</td>
</tr>
<tr>
<th>
<a href="/213?category=361027">씹어먹는 C++ - &lt;7 - 1. C++ 에서의 입출력 (istream, ostream)&gt;</a>&nbsp;&nbsp;<span>(35)</span>
</th>
<td>
2015.05.04</td>
</tr>
</tbody></table></div></div>
<br> <br>


					